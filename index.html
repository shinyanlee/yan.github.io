<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026 é¦¬å¹´å¤§å‰ - ç´…åŒ…æŠ½çè½‰ç›¤</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&display=swap');

        :root {
            --primary-red: #d32f2f;
            --gold: #ffd700;
            --dark-red: #8b0000;
        }

        body {
            background-color: var(--dark-red);
            background-image: radial-gradient(circle, #b71c1c 0%, #8b0000 100%);
            color: var(--gold);
            font-family: 'Ma Shan Zheng', cursive, system-ui, -apple-system, sans-serif;
            overflow-x: hidden;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .wheel-outer {
            position: relative;
            width: 320px;
            height: 320px;
            margin: 0 auto;
            filter: drop-shadow(0 0 25px rgba(0,0,0,0.6));
        }

        #wheelCanvas {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 10px solid var(--gold);
            transform: rotate(0deg);
            /* ç§»é™¤ transition æ”¹ç”± JS æ§åˆ¶ */
        }

        .pointer {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            width: 46px;
            height: 56px;
            background: var(--gold);
            clip-path: polygon(50% 100%, 0 0, 100% 0);
            z-index: 30;
            filter: drop-shadow(0 4px 4px rgba(0,0,0,0.4));
        }

        .spin-btn {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 66px;
            height: 66px;
            background: var(--gold);
            border: 4px solid var(--primary-red);
            border-radius: 50%;
            z-index: 40;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary-red);
            font-weight: bold;
            font-size: 1.4rem;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0,0,0,0.4);
            transition: all 0.2s;
            user-select: none;
        }

        .spin-btn:active {
            transform: translate(-50%, -50%) scale(0.9);
        }

        .spin-btn:disabled {
            filter: grayscale(0.8);
            cursor: not-allowed;
            opacity: 0.8;
        }

        .lantern {
            position: absolute;
            top: 20px;
            font-size: 3rem;
            animation: swing 3s ease-in-out infinite;
            z-index: 10;
        }

        @keyframes swing {
            0%, 100% { transform: rotate(-8deg); }
            50% { transform: rotate(8deg); }
        }

        .modal-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.9);
            z-index: 100;
            align-items: center;
            justify-content: center;
            padding: 20px;
            backdrop-filter: blur(8px);
        }

        .packet-card {
            background: linear-gradient(145deg, #f44336 0%, #b71c1c 100%);
            border: 3px solid var(--gold);
            border-radius: 20px;
            padding: 2.5rem;
            text-align: center;
            width: 100%;
            max-width: 320px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.8);
            animation: packetPop 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes packetPop {
            0% { transform: scale(0.6); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        .firework {
            position: fixed;
            pointer-events: none;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            z-index: 110;
        }
        
        /* éŸ³é‡é–‹é—œ */
        .sound-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(255, 215, 0, 0.2);
            border: 1px solid var(--gold);
            padding: 8px 12px;
            border-radius: 99px;
            cursor: pointer;
            z-index: 50;
        }
    </style>
</head>
<body class="p-4">

    <button class="sound-toggle" onclick="toggleMute()" id="muteBtn">ğŸ”Š éŸ³æ•ˆå·²é–‹å•Ÿ</button>

    <div class="lantern left-[8%]">ğŸ®</div>
    <div class="lantern right-[8%]" style="animation-delay: 1.5s;">ğŸ®</div>

    <header class="text-center mb-10">
        <h1 class="text-5xl md:text-7xl font-bold mb-3 drop-shadow-[0_4px_4px_rgba(0,0,0,0.5)]">
            ä¸€é¦¬ç•¶å…ˆ
        </h1>
        <p class="text-2xl text-yellow-200 tracking-widest">éƒ­ç¾å¥³ç´…åŒ…åŠ ç¢¼æŠ½æŠ½æ¨‚</p>
    </header>

    <div class="wheel-outer">
        <div class="pointer"></div>
        <canvas id="wheelCanvas" width="600" height="600"></canvas>
        <button id="spinBtn" class="spin-btn">æŠ½!</button>
    </div>

    <div class="mt-14 w-full max-w-sm bg-black/30 backdrop-blur-sm p-6 rounded-2xl border border-yellow-600/30 text-center">
        <h3 class="text-yellow-400 text-xl mb-4 font-bold">ğŸ§§ ç´…åŒ…çå‹µçé … ğŸ§§</h3>
        <div class="grid grid-cols-2 gap-3 text-white">
            <div class="bg-red-800/40 py-2 rounded-lg border border-red-700/50">1000 å…ƒ</div>
            <div class="bg-red-800/40 py-2 rounded-lg border border-red-700/50">1200 å…ƒ</div>
            <div class="bg-red-800/40 py-2 rounded-lg border border-red-700/50">1600 å…ƒ</div>
            <div class="bg-red-800/40 py-2 rounded-lg border border-red-700/50">1800 å…ƒ</div>
            <div class="bg-yellow-600/20 py-2 rounded-lg border border-yellow-500/50 col-span-2 text-yellow-300">
                â­ 2000 å…ƒé¦¬å¹´ç‰¹å¤§ç´…åŒ… â­
            </div>
        </div>
    </div>

    <div id="modal" class="modal-overlay">
        <div class="packet-card">
            <div class="text-4xl mb-2">ğŸ</div>
            <h2 class="text-2xl text-yellow-300 font-bold mb-2">æ­å–œä¸­ç</h2>
            <p class="text-red-100 opacity-80">ç²å¾—é–‹é‹ç´…åŒ…é‡‘é¡</p>
            <div id="resultText" class="text-6xl font-black text-white my-6 drop-shadow-lg">$0</div>
            <p class="text-yellow-100 text-lg mb-8">ç¥æ‚¨é¦¬åˆ°æˆåŠŸï¼Œè²¡æºæ»¾é€²ï¼</p>
            <button onclick="closeModal()" class="w-full bg-yellow-500 hover:bg-yellow-400 text-red-900 font-bold py-4 rounded-full shadow-lg transition-transform active:scale-95">
                æ”¶ä¸‹å¥½é‹
            </button>
        </div>
    </div>

    <script>
        // éŸ³æ•ˆç®¡ç†å™¨
        const AudioFX = {
            ctx: null,
            isMuted: false,
            init() {
                if (!this.ctx) {
                    this.ctx = new (window.AudioContext || window.webkitAudioContext)();
                }
            },
            playTick() {
                if (this.isMuted || !this.ctx) return;
                const osc = this.ctx.createOscillator();
                const gain = this.ctx.createGain();
                osc.type = 'triangle';
                osc.frequency.setValueAtTime(440, this.ctx.currentTime);
                osc.frequency.exponentialRampToValueAtTime(110, this.ctx.currentTime + 0.05);
                gain.gain.setValueAtTime(0.1, this.ctx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, this.ctx.currentTime + 0.05);
                osc.connect(gain);
                gain.connect(this.ctx.destination);
                osc.start();
                osc.stop(this.ctx.currentTime + 0.05);
            },
            playWin() {
                if (this.isMuted || !this.ctx) return;
                const playNote = (freq, delay, duration) => {
                    const osc = this.ctx.createOscillator();
                    const gain = this.ctx.createGain();
                    osc.type = 'sine';
                    osc.frequency.setValueAtTime(freq, this.ctx.currentTime + delay);
                    gain.gain.setValueAtTime(0, this.ctx.currentTime + delay);
                    gain.gain.linearRampToValueAtTime(0.2, this.ctx.currentTime + delay + 0.05);
                    gain.gain.exponentialRampToValueAtTime(0.01, this.ctx.currentTime + delay + duration);
                    osc.connect(gain);
                    gain.connect(this.ctx.destination);
                    osc.start(this.ctx.currentTime + delay);
                    osc.stop(this.ctx.currentTime + delay + duration);
                };
                playNote(523.25, 0, 0.5); // C5
                playNote(659.25, 0.1, 0.5); // E5
                playNote(783.99, 0.2, 0.8); // G5
                playNote(1046.50, 0.3, 1.0); // C6
            }
        };

        const prizes = [
            { label: "1000", amount: 1000, weight: 25, color: "#e53935" },
            { label: "1200", amount: 1200, weight: 25, color: "#d32f2f" },
            { label: "1600", amount: 1600, weight: 20, color: "#c62828" },
            { label: "1800", amount: 1800, weight: 20, color: "#b71c1c" },
            { label: "2000", amount: 2000, weight: 10, color: "#ffc107" }
        ];

        const canvas = document.getElementById('wheelCanvas');
        const ctx = canvas.getContext('2d');
        const spinBtn = document.getElementById('spinBtn');
        const modal = document.getElementById('modal');
        const resultText = document.getElementById('resultText');

        let currentAngle = 0;
        let isSpinning = false;

        function toggleMute() {
            AudioFX.isMuted = !AudioFX.isMuted;
            document.getElementById('muteBtn').innerText = AudioFX.isMuted ? "ğŸ”‡ éŸ³æ•ˆå·²é—œé–‰" : "ğŸ”Š éŸ³æ•ˆå·²é–‹å•Ÿ";
        }

        function drawWheel() {
            const size = canvas.width;
            const center = size / 2;
            const radius = center - 15;
            const sliceAngle = (2 * Math.PI) / prizes.length;

            ctx.clearRect(0,0,size,size);
            prizes.forEach((prize, i) => {
                const startAngle = i * sliceAngle;
                ctx.beginPath();
                ctx.moveTo(center, center);
                ctx.arc(center, center, radius, startAngle, startAngle + sliceAngle);
                ctx.closePath();
                ctx.fillStyle = prize.color;
                ctx.fill();
                ctx.strokeStyle = '#ffd700';
                ctx.lineWidth = 5;
                ctx.stroke();

                ctx.save();
                ctx.translate(center, center);
                ctx.rotate(startAngle + sliceAngle / 2);
                ctx.textAlign = "right";
                ctx.fillStyle = prize.color === "#ffc107" ? "#d32f2f" : "#ffd700";
                ctx.font = "bold 36px system-ui";
                ctx.fillText(prize.label, radius - 40, 12);
                ctx.restore();
            });
        }

        function easeOutCubic(t) {
            return 1 - Math.pow(1 - t, 3);
        }

        function startSpin() {
            if (isSpinning) return;
            AudioFX.init();
            isSpinning = true;
            spinBtn.disabled = true;

            const random = Math.random() * 100;
            let cumulativeWeight = 0;
            let winningIndex = 0;
            for (let i = 0; i < prizes.length; i++) {
                cumulativeWeight += prizes[i].weight;
                if (random <= cumulativeWeight) {
                    winningIndex = i;
                    break;
                }
            }

            const degreesPerSlice = 360 / prizes.length;
            const winningMidAngle = (winningIndex * degreesPerSlice) + (degreesPerSlice / 2);
            const pointerPos = 270; 
            const currentMod = currentAngle % 360;
            const extraDegrees = (pointerPos - winningMidAngle - currentMod + 360) % 360;
            
            const rounds = 8 + Math.floor(Math.random() * 4);
            const targetRotation = rounds * 360 + extraDegrees;
            const startRotation = currentAngle;
            
            const duration = 5000;
            const startTime = performance.now();
            let lastSliceIndex = Math.floor((currentAngle % 360) / degreesPerSlice);

            function animate(now) {
                const elapsed = now - startTime;
                const progress = Math.min(elapsed / duration, 1);
                const easeProgress = easeOutCubic(progress);
                
                currentAngle = startRotation + targetRotation * easeProgress;
                canvas.style.transform = `rotate(${currentAngle}deg)`;

                // æª¢æ¸¬æ˜¯å¦ç¶“éæ–°çš„æ ¼å­åˆ†ç•Œç·šï¼Œè§¸ç™¼éŸ³æ•ˆ
                // æˆ‘å€‘éœ€è¦æª¢æ¸¬ç›¸å°æ–¼æŒ‡é‡çš„ä½ç½®
                const relativeAngle = (pointerPos - currentAngle % 360 + 360) % 360;
                const currentSliceIndex = Math.floor(relativeAngle / degreesPerSlice);
                
                if (currentSliceIndex !== lastSliceIndex) {
                    AudioFX.playTick();
                    lastSliceIndex = currentSliceIndex;
                }

                if (progress < 1) {
                    requestAnimationFrame(animate);
                } else {
                    isSpinning = false;
                    spinBtn.disabled = false;
                    AudioFX.playWin();
                    showModal(prizes[winningIndex].amount);
                }
            }
            requestAnimationFrame(animate);
        }

        function showModal(amount) {
            resultText.innerText = `$${amount}`;
            modal.style.display = 'flex';
            launchFireworks();
        }

        function closeModal() {
            modal.style.display = 'none';
        }

        function launchFireworks() {
            for (let i = 0; i < 30; i++) {
                setTimeout(() => {
                    const fw = document.createElement('div');
                    fw.className = 'firework';
                    fw.style.left = Math.random() * 100 + 'vw';
                    fw.style.top = Math.random() * 100 + 'vh';
                    fw.style.backgroundColor = `hsl(${Math.random() * 360}, 100%, 60%)`;
                    fw.style.boxShadow = `0 0 15px 5px white`;
                    document.body.appendChild(fw);
                    const ani = fw.animate([{ transform: 'scale(0)', opacity: 1 }, { transform: 'scale(40)', opacity: 0 }], { duration: 1000, easing: 'ease-out' });
                    ani.onfinish = () => fw.remove();
                }, i * 100);
            }
        }

        window.onload = () => {
            drawWheel();
            spinBtn.addEventListener('click', startSpin);
        };
    </script>
</body>
</html>